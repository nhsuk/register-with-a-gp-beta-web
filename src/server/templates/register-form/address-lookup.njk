{% extends 'layouts/base.njk' %}

{% block head_title_content %}{{ title | render }} - NHS.UK{% endblock %}

{% block body_main_content %}
  <div class="page-section">
    {% if prevStep %}
      <div class="form-group">
        <a href="{{ prevStep }}"  class="button button--back">Back</a>
      </div>
    {% endif %}
    {% component 'error-summary', { children: stepErrors } %}
    <h1 class="form-title">{{ title | render | safe }}</h1>
    <form method="post" id="current-step-form" class="{{key}}-form" >
      <input type="hidden" name="csrf" value="{{csrf}}">
      <input type="hidden" id="practice" value="{{ CURRENT_PRACTICE.key }}">
      
      {% block formFields %}
        <div class="form-fields">
          {% for field in fields %}
            {% if field.componentType in ['textbox', 'multiple-choice', 'disclosure', 'dropdown', 'numeric', 'tel','radio-horizontal', 'hidden'] %}
              {% component 'form-' + field.componentType, {
            label: field.label,
            name: field.id,
            children: field.children,
            hint: field.hint,
            variant: field.variant,
            error: stepErrors[field.id].message | replace(stepErrors[field.id].label, ""),
            value: stepData[field.id],
            componentText: field.text
          } %}
            {% endif %}
          {% endfor %}
          <div class="form-group addresslookup">
           <button type="button" id="addressbutton" class="button findAddress">Find address</button>
           </div>
        </div>
        
      {% endblock %}
      {% block confirm %}
        <div class="address-confirm" id="address-confirm">
          <span class="reset-address"><a href class="confirm-reset">reset </a>x</span> 
          <div class="confirm-address-details">
           <p> <span class="address-confirm-line" id="confirmAddress1"></span>
            <span class="address-confirm-line" id="confirmAddress2"></span></p>
            <p class="address-confirm-line" id="confirmAddress3"></p>
            <p class="address-confirm-line" id="confirmTown"></p>
            <p class="address-confirm-line" id="confirmCounty"></p>
          </div>
          
        </div>
      {% endblock %}
      {% block submitRow %}
        <div id="address-lookup-continue" class="form-group continue-step">
         
          <button type="submit" id="addresscontinue" class="button">Continue</button>
        </div>
       <ul class="address-results" id="address-results">
       </ul>
      {% endblock submitRow %}
      <details id="manualDiv">
        <summary>
          <span class="details__summary">I can't find my address, enter manually</span>
        </summary>
        <div class="details__content">
          <div class="callout callout--info">
            <p>Address</p>
            <input type="input" id="manualAddress1" value="" />
            <input type="input" id="manualAddress2" value="" />
            <input type="input" id="manualAddress3" value="" />
            <p>Town or city</p>
            <input type="input" id="manualTown" value="" />
            <p>County</p>
            <input type="input" id="manualCounty" value="" />
            <p>Postcode</p>
            <input type="input" id="manualPostcode" value="" />
            <button type="submit" id="manualcontinue" class="button">Continue</button>

          </div>
        </div>
      </details>
    </form>
  </div>
{% component 'analytics', {
  ga_client_ID: cid
  } %}
{% endblock body_main_content %}
